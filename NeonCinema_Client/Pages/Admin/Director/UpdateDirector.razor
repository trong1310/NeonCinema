@page "/updateDirector/{DRTId:guid}"
@using NeonCinema_Application.DataTransferObject.Directors
@using NeonCinema_Client.Data.IServices.Director
@using NeonCinema_Domain.Enum
@inject IDirectorService SV
@inject NavigationManager NavigationManager
@layout LayoutAdmin
<link rel="stylesheet" href="/css/Director/UpdateDirector.css">
<h3 class="text-center mb-4">Update Director</h3>

@if (DRT == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="CL0">
       
        <div class="CL2">
            <EditForm Model="DRT" OnValidSubmit="HandleValidSubmit" class="form-container">
                <div class="CL3">
                    <div class="mb-3">
                        <label class="form-label">Full Name:</label>
                        <InputText @bind-Value="DRT.FullName" class="form-control" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Gender:</label>
                        <InputSelect id="gender" class="form-select" @bind-Value="DRT.Gender" required>
                            <option value="">-- Chọn giới tính --</option>
                            <option value="@(EntityStatus.Men)">Nam</option>
                            <option value="@(EntityStatus.Girl)">Nữ</option>
                        </InputSelect>
                        <ValidationMessage For="@(() => DRT.Gender)" />
                    </div>
                </div>


                <div class="CL4">
                   
                    <div class="mb-3">
                        <label class="form-label">Nationality:</label>
                        <InputText @bind-Value="DRT.Nationality" class="form-control" />
                    </div>
                </div>


                <div class="CL5">
                    <div class="mb-3">
                        <label class="form-label">Biography:</label>
                        <InputTextArea @bind-Value="DRT.Biography" class="form-control" rows="3" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Status:</label>
                        <InputSelect id="status" class="form-select" @bind-Value="DRT.Status">
                            <option value="@(EntityStatus.Active)">Hoạt động</option>
                            <option value="@(EntityStatus.Locked)">Không hoạt động</option>
                        </InputSelect>
                        <ValidationMessage For="@(() => DRT.Status)" />
                    </div>
                </div>
                



                <button type="submit" class="btn btn-primary">Save</button>
                <button type="button" class="btn btn-secondary ms-2" @onclick="NavigateBack">Cancel</button>
            </EditForm>
        </div>
    </div>
}

@code {
    [Parameter] public Guid DRTId { get; set; }
    private DirectorDTO DRT = new DirectorDTO();
   

    protected override async Task OnInitializedAsync()
    {
        DRT = await SV.GetByIdDirector(DRTId);
        
    }

    

    private async Task HandleValidSubmit()
    {
        var updateActorRequest = new UpdateDirectorRequest
            {
                ID = DRT.ID,
                FullName = DRT.FullName,
                Gender = DRT.Gender,               
                Address = DRT.Address,
                Nationality = DRT.Nationality,
                Biography = DRT.Biography,              
                Status = DRT.Status
            };

        await SV.UpdateDirector(DRT.ID, updateActorRequest);

        NavigationManager.NavigateTo("/listDirector");
    }

    private void NavigateBack()
    {
        NavigationManager.NavigateTo("/listDirector");
    }
}
