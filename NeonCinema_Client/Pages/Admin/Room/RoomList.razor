@page "/listroom"
@using NeonCinema_Application.DataTransferObject.Cinemas
@using NeonCinema_Application.DataTransferObject.Room
@using NeonCinema_Client.Data.IServices.IRoom
@inject IRoomService RoomService
@inject NavigationManager Navigation
@inject IJSRuntime JS
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<h3 class="text-center mb-4">Danh Sách Phòng Chiếu</h3>

@if (rooms == null)
{
    <p class="text-center">Đang tải danh sách phòng chiếu...</p>
}
else if (rooms.Count == 0)
{
    <p class="text-center">Không có phòng chiếu nào.</p>
}
else
{
    <div class="mb-3 text-right">
        <button class="btn btn-success btn-lg" @onclick="AddRoom" data-bs-toggle="tooltip" data-bs-placement="top" title="Thêm phòng chiếu">
            <i class="bi bi-plus-circle"></i>
        </button>
    </div>


    <div class="table-responsive">
        <table class="table table-striped table-hover table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>Tên Phòng</th>
                    <th>Sức Chứa</th>
                    <th>Tên Rạp</th>
                    <th>Số Hàng</th>
                    <th>Số Cột</th>
                    <th>Trạng Thái</th>
                    <th>Thao Tác</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var room in rooms)
                {
                    var cinema = cinemasdto.FirstOrDefault(c => c.ID == room.CinemasId);
                    <tr>
                        <td>@room.Name</td>
                        <td>@(room.RowNumber * room.ColumnNumber)</td>
                        <td>@cinema?.Name</td>
                        <td>@room.RowNumber</td>
                        <td>@room.ColumnNumber</td>
                        <td>@room.Status.ToString()</td>
                        <td>
                            <button class="btn btn-sm" @onclick="() => ViewRoomDetails(room.ID)">
                                <i class="bi bi-eye"></i> 
                            </button>
                            <button class="btn btn-sm" @onclick="() => EditRoom(room.ID)">
                                <i class="bi bi-pencil"></i> 
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}

@code {
    private List<RoomDTO> rooms;

    private List<CinemasDTO> cinemasdto;
    
    protected override async Task OnInitializedAsync()
    {
        rooms = await RoomService.GetAllRooms();
        cinemasdto = await RoomService.GetAllCinemas();
    }

    private void ViewRoomDetails(Guid roomId)
    {
        Navigation.NavigateTo($"/roomdetails/{roomId}");
    }

    private void EditRoom(Guid roomId)
    {
        Navigation.NavigateTo($"/editroom/{roomId}");
    }

    private void AddRoom()
    {
        Navigation.NavigateTo("/addroom");
    }
}

<style>
    /* Custom styling for the page */
    .table-responsive {
        margin-top: 20px;
    }

    .table th, .table td {
        vertical-align: middle;
        text-align: center;
    }

    .table td {
        font-size: 14px;
    }

    .table th {
        background-color: #343a40;
        color: white;
    }

    .btn {
        margin: 5px;
    }

    .btn-lg {
        padding: 12px 24px;
    }

   
    .btn-sm {
        padding: 5px 10px;
       
    }

    .btn-info, .btn-warning {
        font-size: 16px;
    }

    .text-right {
        text-align: left;
    }

    .mb-4 {
        margin-bottom: 2rem;
    }

    .bi {
        margin-right: 5px;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #f9f9f9;
    }

    .table-hover tbody tr:hover {
        background-color: #f1f1f1;
    }
</style>
